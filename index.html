<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>Safety with Agency: Human-Centered Safety Filter with Application to AI-Assisted Motorsports </title>
<!--    <meta property="og:image" content="img/hri.webp" />-->
    <meta name="description" content="Safety with Agency: Human-Centered Safety Filter with Application to AI-Assisted Motorsports">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <base href="/"> -->

<!--     <link rel="apple-touch-icon" href="apple-touch-icon.png"> -->
  <!-- <link rel="icon" type="image/png" href="img/seal_icon.png"> -->

    <link href="//cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
    <link rel="stylesheet" href="css/app.css">
    <link rel="icon" href="img/Princeton_Robotics.png">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.3/clipboard.min.js"></script>
    
    <script src="js/app.js"></script>
	
    <style>
        .nav-pills {
          position: relative;
          display: inline;
        }
        .imtip {
          position: absolute;
          top: 0;
          left: 0;
        }
        video {
          height: 100%;
          width: 100%;
          object-fit: cover;
        }
    </style>
</head>
<body>
    <div class="container" id="main">

        <div class="my-4"></div>
        <div class="my-4"></div>
        <div class="my-4"></div>

        <div class="row mt-4">
            <h2 class="col-md-12 text-center">
                <span class="agency-title">Safety with Agency:</span><br>
                Human-Centered Safety Filter with Application to AI-Assisted Motorsports
            </h2>
        </div>
        
        <div class="row">
            <div class="col-md-12 text-center">
                <ul class="list-inline">
                    <br>
                    <li><a href="https://www.linkedin.com/in/donggeon-oh-75a236239">Donggeon David Oh*</a></li>
                    <li><a href="https://jlidard.github.io">Justin Lidard*</a></li>
                    <li><a href="https://haiminhu.org/">Haimin Hu</a></li>
                    <li><a href="https://himanisinhmar.github.io/">Himani Sinhmar</a></li>
                    <li><a href="https://www.linkedin.com/in/elle-lazarski/">Elle Lazarski</a></li>
                    <br>
                    <li><a href="https://scholar.google.com/citations?user=qqMpCwYAAAAJ&hl=en">Deepak Gopinath</a></li>
                    <li><a href="https://www.linkedin.com/in/emilysarahsumner/">Emily Sumner</a></li>
                    <li><a href="https://jadecastro.github.io/">Jonathan DeCastro</a></li>
                    <li><a href="http://people.csail.mit.edu/rosman/">Guy Rosman</a></li>
                    <li><a href="https://mae.princeton.edu/people/faculty/leonard/">Naomi Leonard</a></li>
                    <li><a href="https://saferobotics.princeton.edu/jaime">Jaime Fernández Fisac</a></li>
                </ul>
            </div>
        </div>
        <!-- <div class="row">
            <div class="col-md-12 text-center">
                <ul class="list-inline">
                    <br>
                    <li><a href="https://scholar.google.com/citations?user=qqMpCwYAAAAJ&hl=en">Deepak Gopinath</a></li>
                    <li><a href="https://www.linkedin.com/in/emilysarahsumner/">Emily Sumner</a></li>
                    <li><a href="https://jadecastro.github.io/">Jonathan DeCastro</a></li>
                    <li><a href="http://people.csail.mit.edu/rosman/">Guy Rosman</a></li>
                    <li><a href="https://mae.princeton.edu/people/faculty/leonard/">Naomi Leonard</a></li>
                    <li><a href="https://saferobotics.princeton.edu/jaime">Jaime Fernández Fisac</a></li>
                </ul>
            </div>
        </div> -->

        <div class="my-4"></div>

        <div class="row justify-content-center align-items-center text-center">
            <div class="col-md-12">
            <h3>
                <a href="https://roboticsconference.org/"
                   target="_blank"
                   rel="noopener noreferrer"
                   style="font-size: 18pt;"></a>
                  Robotics: Science and Systems (R:SS) 2025
                </a>
            </h3>
            </div>
        </div>

        <div class="my-4"></div>

        <div class="row justify-content-center align-items-center">
            <!-- <div class="col-md-2 text-center">
              <h3>
                <a href="https://roboticsconference.org/"
                   target="_blank"
                   rel="noopener noreferrer">
                  RSS 2025
                </a>
              </h3>
            </div> -->
          
            <div class="col-md-1 text-center">
              <h3>
                <a href="https://arxiv.org/pdf/2504.11717"
                   target="_blank"
                   rel="noopener noreferrer"
                   style="font-size: 18pt;">
                  Paper
                </a>
              </h3>
            </div>
          
            <div class="col-md-1 text-center">
                <h3>|</h3>
            </div>

            <div class="col-md-1 text-center">
              <h3>Code (TBA)</h3>
            </div>
        </div>          

        <div class="my-4"></div>
        <div class="my-4"></div>

        <div class="row justify-content-center align-items-center">
            <div class="col-md-3 text-center">
              <a href="https://www.princeton.edu/">
                <img
                  src="img/PU1line-cropped.svg"
                  alt="Princeton Logo"
                  height="80"
                  class="img-fluid"
                >
              </a>
            </div>
            <div class="col-md-2 text-center">
              <a href="https://www.tri.global/">
                <img
                  src="img/toyota-research-institute.png"
                  alt="TRI Logo"
                  height="80"
                  class="img-fluid"
                >
              </a>
            </div>
        </div>

        <div class="my-4"></div>

        <div class="row justify-content-md-center">
            <div class="col-md-10 col-lg-8">
                <h3 class="mt-4 mb-2 section-title">
                    TL;DR
                </h3>
                <p class="text-justify">
                    We propose a <em>human-centered safety filter (HCSF)</em> for shared autonomy that significantly enhances system safety without compromising human agency. 
                    Our HCSF is built upon a novel <em>state&ndash;action control barrier function (Q-CBF)</em> safety filter, which does not require any knowledge of the system dynamics for both synthesis and runtime safety enforcement.
                </p>
                <div class="col-md-12">
                    <video
                    id="v0"
                    width="60%"
                    preload="metadata"
                    autoplay
                    muted
                    playsinline
                    controls
                    >
                        <source src="videos/safety_with_agency_short_compressed.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>

        <div class="row justify-content-md-center">
            <div class="col-md-10 col-lg-8">
                <h3 class="mt-4 mb-2 section-title">
                    Abstract
                </h3>
                <p class="text-justify">
                    We propose a human-centered safety filter (HCSF) for shared autonomy that significantly enhances system safety without compromising human agency. 
                    Our HCSF is built on a neural safety value function, which we first learn scalably through black-box interactions and then use at deployment to enforce a novel state&ndash;action control barrier function (Q-CBF) safety constraint.
                    Since this Q-CBF safety filter does not require any knowledge of the system dynamics for both synthesis and runtime safety monitoring and intervention, our method applies readily to complex, black-box shared autonomy systems.
                    Notably, our HCSF's CBF-based interventions modify the human's actions minimally and smoothly, avoiding the abrupt, last-moment corrections delivered by many conventional safety filters.
                    We validate our approach in a comprehensive in-person user study using Assetto Corsa&mdash;a high-fidelity car racing simulator with black-box dynamics&mdash;to assess robustness in &ldquo;driving on the edge&rdquo; scenarios.
                    We compare both trajectory data and drivers’ perceptions of our HCSF assistance against unassisted driving and a conventional safety filter.
                    Experimental results show that 1) compared to having no assistance, our HCSF improves both safety and user satisfaction without compromising human agency or comfort, and 2) relative to a conventional safety filter, our proposed HCSF boosts human agency, comfort, and satisfaction while maintaining robustness.
                </p>
            </div>
        </div>

        <div class="row justify-content-md-center">
            <div class="col-md-10 col-lg-8">
              <h3 class="mt-4 mb-2 section-title">Contributions</h3>
              <ul class="list-group list-group-flush">
                <li class="list-group-item">
                  We introduce, to the best of our knowledge, the <em>first fully model‑free control barrier function (CBF) safety filter</em>.  
                  We learn a neural safety value function through interactions with a black‑box system and, at deployment, enforce a safety constraint based on a novel Q-CBF without any knowledge of system dynamics (e.g., control affine model).  
                  Both the synthesis and deployment of our Q‑CBF are scalable to high‑dimensional systems and do not require any knowledge of their dynamics.
                </li>
                <li class="list-group-item">
                  We build upon the learned Q‑CBF and demonstrate our HCSF in Assetto Corsa (AC), a high‑fidelity racing simulator with black‑box dynamics, where the filter is pushed to the limit against all potential failure modes by real human drivers with diverse skill levels.  
                  To the best of our knowledge, this is the first time a safety filter has been synthesized, deployed, and evaluated in such a high‑dimensional, dynamic shared autonomy setting involving human operators.
                </li>
                <li class="list-group-item">
                  We conduct an extensive in‑person user study with 83 human participants and conclude&mdash;with statistical significance in both trajectory data and human driver responses&mdash;that our HCSF considerably improves safety and user satisfaction without compromising human agency or comfort relative to having no safety filter.  
                  Furthermore, when compared to a conventional safety filter, our HCSF offers significant gains in human agency, comfort, and overall satisfaction while maintaining at least the same level of robustness&mdash;if not exceeding it.
                </li>
              </ul>
              <p style="text-align:center;">
                <figure class="text-center">
                    <img src="img/saferacing_rss25_figures.004.jpeg" width="100%" class="img-fluid" alt="hairpin corner">
                    <figcaption class="mt-2">Illustration of our HCSF intervention at a hairpin corner. Our HCSF monitors the state and the human action to provide necessary steering and braking interventions that keep the vehicle on the track.</figcaption>
                </figure>
            </p>
            </div>
        </div>

        <div class="row justify-content-md-center">
            <div class="col-md-10 col-lg-8">
                <h3 class="mt-4 mb-2 section-title">
                    Approach
                </h3>
                <p class="text-justify">
                    Our HCSF builds upon a novel Q-CBF safety filter, which is, to the best of our knowledge, the first fully model-free CBF safety filter.
                    We first prove that the safety value function is a valid discrete-time CBF.
                    Then, we scalably learn a state&ndash;action safety value function through black-box interations with the system via model-free RL-based Hamilton-Jacobi (HJ) reachability analysis.
                    At runtime, we leverage the learned state&ndash;action safety value function to enforce a novel Q-CBF safety constraint, which does not require any knowledge of the system dynamics for both safety monitoring and intervention.
                    Therefore, our Q‑CBF safety filter is fully model‑free&mdash;from synthesis through deployment&mdash;unlocking a wide range of applications for complex, black‑box systems.
                </p>
                <p class="text-justify">
                    During deployment, our HCSF solves an optimal control problem (OCP) at each timestep to compute a safe action that minimally deviates from the human's intended action while satisfying the Q-CBF safety constraint.
                    Thus, our HCSF actively promotes human agency while ensuring the system remains within the maximal safe set.
                    Whenever an intervention occurs, our HCSF provides visual cues that reflect the intervention magnitude at each input channel, fostering transparent collaboration with the human operator.
                </p>
                <p style="text-align:center;">
                    <figure class="text-center">
                        <img src="img/saferacing_rss25_figures.005.png" width="100%" class="img-fluid" alt="control diagram">
                        <figcaption class="mt-2">A diagram describing the interaction between a human operator, our HCSF, and AC environment.</figcaption>
                    </figure>
                </p>
            </div>
        </div>

        <div class="row justify-content-md-center">
            <div class="col-md-10 col-lg-8">
                <h3 class="mt-4 mb-2 section-title">
                    Results
                </h3>
                <p class="text-justify">
                    We conducted a large-scale user study in an AI-assisted car racing environment using AC to assess the robustness of our HCSF and how human operators perceive its interventions.
                    We compare our HCSF against unassisted driving and a last resort safety filter (LRSF)&mdash;a conventional value-based safety filter that switches to the fallback policy when the current state is deemed unsafe.
                    Both trajectory data and the users' subjective responses were used to validate our hypotheses:
                    <ol>
                        <li><strong>compared to unassisted driving, our HCSF improves safety and satisfaction without compromising human agency and comfort.</strong></li>
                        <li><strong>compared to LRSF, our HCSF enhances human agency, comfort, and satisfaction while maintaining robustness.</strong></li>
                    </ol>
                    Each participant (N=83) was assigned to one of three assistance modes&mdash;unassisted, LRSF assistance, or HCSF assistance&mdash;and completed three driving sessions.
                    Sessions 1 and 3 were unassisted for everyone; in session 2, only the LRSF and HCSF groups received their respective safety‑filter assistance, while the unassisted group continued without support.
                    This study marks the first time the interaction between human operators and safety filters has been systematically investigated.
                </p>
                <p class="text-justify">
                    Our HCSF achieved near-zero failures in session 2 for all participants in the group, demonstrating significant enhancement in safety compared to unassisted driving. 
                    Although our HCSF outperformed LRSF in both failure modes (i.e., out-of-track incidents and collisions), the differences were not statistically significant.
                    In the figures below, statistical significance is indicated by asterisks (* corresponds to p &lt; 0.05; ** to  p &lt; 0.01; *** to  p &lt; 0.001).
                </p>
                <div class="row justify-content-center text-center mt-4">
                    <div class="col-md-4 mb-3">
                      <img src="img/out_of_track_per_min_side_by_side.png"
                           class="img-fluid"
                           alt="Out‑of‑track per minute">
                      <figcaption class="mt-2">Out‑of‑track incidents per minute</figcaption>
                    </div>
                    <div class="col-md-4 mb-3">
                      <img src="img/collisions_per_prox_side_by_side_3m.png"
                           class="img-fluid"
                           alt="Collisions per minute">
                      <figcaption class="mt-2">Collisions per minute (&lt; 3m)</figcaption>
                    </div>
                    <div class="col-md-4 mb-3">
                      <img src="img/failures_per_min_stacked.png"
                           class="img-fluid"
                           alt="Failures per minute">
                      <figcaption class="mt-2">Total number of failures per minute</figcaption>
                    </div>
                </div>
                <p class="text-justify">
                    A similar trend emerges in the user responses as well.
                    Participants assisted by our HCSF in session 2 felt significantly more confident in the safety filter's robustness than those in the unassisted group.
                    Although participants in the HCSF group also reported higher confidence than those in the LRSF group, this difference was not statistically significant.
                </p>
                <p style="text-align:center;">
                    <figure class="text-center">
                        <img src="img/box_s1s2_and_delta_robustness.png" width="75%" class="img-fluid" alt="Robustness responses">
                        <figcaption>Users' perceived robustness across all three groups in sessions 1 and 2.</figcaption>
                    </figure>
                </p>
                <p class="text-justify">
                    The histogram below reports the distribution of I.M. (input modification magnitude) among all participants in each group across all timesteps&mdash;including those when no safety filter intervention occured&mdash;for the HCSF and LRSF groups, thus jointly capturing intervention frequency and magnitude.
                    Our HCSF reduces the frequency of large interventions relative to LRSF, so the filtered actions remain closer to the human operator's intended actions.
                    In other words, our HCSF enhances human agency over LRSF by offering human-centered nudges of smaller magnitude.
                    By contrast, LRSF does not take into account the human action, often leading to unnecessarily large corrections that undermine the human's sense of control.
                </p>
                <p style="text-align:center;">
                    <figure class="text-center">
                        <img src="img/histogram_abs_action_diff_L2_nonzero_broken_y.png" width="50%" class="img-fluid" alt="Histogram of input modification magnitudes">
                        <figcaption>Histogram of I.M. for the HCSF and LRSF groups across all timesteps.</figcaption>
                    </figure>
                </p>
                <p class="text-justify">
                    Qualitative responses from participants also strongly support the improved human agency of our HCSF over LRSF.
                    As shown in the box plot below, participants assisted by our HCSF during session 2 reported a significantly stronger sense of being in control compared to those assisted by LRSF.
                    Meanwhile, the unassisted group recorded the highest average agency score&mdash;unsurprising because they had full control of the vehicle in all sessions&mdash;but its difference from the HCSF group was not statistically significant.
                </p>
                <p style="text-align:center;">
                    <figure class="text-center">
                        <img src="img/box_s1s2_and_delta_agency.png" width="75%" class="img-fluid" alt="Agency responses">
                        <figcaption>Users' perceived agency across all three groups in sessions 1 and 2.</figcaption>
                    </figure>
                </p>
                <p class="text-justify">
                    The box plots below show the distributions of average I.D. (squared magnitude of the first-order control input difference) and jerk for all three groups.
                    Notably, our HCSF significantly reduces both average I.D. and jerk compared to LRSF, while its difference from unassisted driving is not statistically significant.
                    This indicates that our HCSF's interventions are smoother and less abrupt than those of LRSF, leading to improved user comfort.
                    We conjecture that our HCSF's smooth interventions are due to 1) the Q-CBF safety constraint that delivers more gradual interventions compared to the swithcing behavior of LRSF, and 2) our HCSF anchoring the filtered action around the human's action, which is inherently smooth and continuous.
                </p>
                <div class="row justify-content-center text-center mt-4">
                    <div class="col-6 col-sm-4 mb-3">
                      <img src="img/avg_1st_diff_box.png"
                           class="img-fluid"
                           alt="Box plot of average I.D.">
                      <figcaption class="mt-2">Box plot of average I.D.</figcaption>
                    </div>
                    <div class="col-6 col-sm-4 mb-3">
                      <img src="img/avg_jerk_box.png"
                           class="img-fluid"
                           alt="Box plot of average jerk">
                      <figcaption class="mt-2">Box plot of average jerk.</figcaption>
                    </div>
                    <!-- if you have a third figure, add another col-sm-4 here -->
                </div>
                <p class="text-justify">
                    Participants' reported sense of smoothness also supports improved user comfort with our HCSF over LRSF.
                    As shown in the box plot below, participants assisted by our HCSF reported a significantly higher smoothness score in session 2 compared to those assisted by LRSF.
                    Similar to the agency results, the unassisted group exhibited the highest average smoothness score, which is unsurprising given the absence of interventions of any sort.
                    Nonetheless, we emphasize that the gap between the HCSF and unassisted groups was not statsistically significant, showing how well our HCSF preserves a smooth and comfortable driving experience.
                </p>
                <p style="text-align:center;">
                    <figure class="text-center">
                        <img src="img/box_s1s2_and_delta_comfort.png" width="75%" class="img-fluid" alt="Agency responses">
                        <figcaption>Users' perceived comfort across all three groups in sessions 1 and 2.</figcaption>
                    </figure>
                </p>
                <p class="text-justify">
                    Finally, participants assisted by our HCSF in session 2 reported significantly higher satisfaction scores than those in the unassisted and LRSF groups.
                </p>
                <p style="text-align:center;">
                    <figure class="text-center">
                        <img src="img/box_s1s2_and_delta_satisfaction.png" width="75%" class="img-fluid" alt="Agency responses">
                        <figcaption>Users' perceived satisfaction across all three groups in sessions 1 and 2.</figcaption>
                    </figure>
                </p>
                <p class="text-justify">
                    Therefore, we validated both hypotheses using both trajectory data and human participant responses from an extensive human study.
                </p>
            </div>
        </div>

<!--        <div class="row justify-content-md-center">-->
<!--            <div class="col-md-10 col-lg-8">-->
<!--                <h3 class="mt-4 mb-2">-->
<!--                    TODO: bimanual videos-->
<!--                </h3>-->
<!--            </div>-->
<!--        </div>-->

        <div class="row justify-content-md-center">
            <div class="col-md-10 col-lg-8">
                <h3 class="mt-4 mb-2 section-title">
                    Citation
                </h3>
                <pre><code class="codeblock">
@inproceedings{oh2025safety,
    title={Safety with Agency: Human-Centered Safety Filter with Application to AI-Assisted Motorsports},
    author={Oh, Donggeon David and Lidard, Justin and Hu, Haimin and Sinhmar, Himani and Lazarski, Elle and Gopinath, Deepak and Sumner, Emily S and DeCastro, Jonathan A and Rosman, Guy and Leonard, Naomi Ehrich and and Fisac, Jaime Fern{\'a}ndez},
    journal={Proceedings of Robotics: Science and Systems},
    year={2025}
}
                </code></pre>
            </div>
        </div>

    </div>
</body>
</html>
